<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crypto Event Study - Lite Dashboard</title>
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;overflow:hidden}
#chart{width:100%;height:calc(100vh - 40px)}
#controls{height:40px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;font-size:11px;border-top:1px solid #ddd}
button{padding:4px 12px;font-size:11px;cursor:pointer;border:1px solid #ccc;background:#fff;border-radius:3px}
button:hover{background:#f5f5f5}
.citation{opacity:0.6;font-size:10px}
body.dark{background:#1a1a1a;color:#e0e0e0}
body.dark #controls{border-top-color:#333}
body.dark button{background:#2a2a2a;color:#e0e0e0;border-color:#444}
body.dark button:hover{background:#333}
</style>
</head>
<body>
<div id="chart"></div>
<div id="controls">
<span class="citation">Farzulla (2025) - Cryptocurrency Event Study</span>
<button onclick="exportChart()">Export PNG</button>
</div>
<script>
const data=[
{crypto:'BTC',mean_infra_effect:1.191,mean_reg_effect:0.32,difference:0.871},
{crypto:'ETH',mean_infra_effect:2.531,mean_reg_effect:0.55,difference:1.981},
{crypto:'XRP',mean_infra_effect:2.386,mean_reg_effect:1.47,difference:0.916},
{crypto:'BNB',mean_infra_effect:2.913,mean_reg_effect:0.16,difference:2.753},
{crypto:'LTC',mean_infra_effect:2.920,mean_reg_effect:0.05,difference:2.870},
{crypto:'ADA',mean_infra_effect:3.371,mean_reg_effect:0.00,difference:3.371}
];

const params=new URLSearchParams(window.location.search);
const cryptoFilter=params.get('crypto')?.split(',').map(c=>c.trim().toUpperCase());
const theme=params.get('theme')||'light';

if(theme==='dark')document.body.classList.add('dark');

const filtered=cryptoFilter?data.filter(d=>cryptoFilter.includes(d.crypto)):data;

const infra={
x:filtered.map(d=>d.crypto),
y:filtered.map(d=>d.mean_infra_effect),
name:'Infrastructure',
type:'bar',
marker:{color:'#3b82f6'}
};

const reg={
x:filtered.map(d=>d.crypto),
y:filtered.map(d=>d.mean_reg_effect),
name:'Regulatory',
type:'bar',
marker:{color:'#ef4444'}
};

const layout={
barmode:'group',
margin:{l:50,r:20,t:30,b:40},
font:{size:11,family:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif'},
xaxis:{title:'Cryptocurrency',titlefont:{size:12}},
yaxis:{title:'Mean Effect (% volatility)',titlefont:{size:12}},
showlegend:true,
legend:{x:0.02,y:0.98,xanchor:'left',yanchor:'top',bgcolor:'rgba(255,255,255,0.8)'},
plot_bgcolor:theme==='dark'?'#1a1a1a':'#ffffff',
paper_bgcolor:theme==='dark'?'#1a1a1a':'#ffffff',
font:{color:theme==='dark'?'#e0e0e0':'#000000'}
};

const config={
responsive:true,
displayModeBar:false
};

Plotly.newPlot('chart',[infra,reg],layout,config);

function exportChart(){
Plotly.downloadImage('chart',{
format:'png',
width:1200,
height:600,
filename:'crypto-event-study'
});
}

window.addEventListener('resize',()=>{
Plotly.Plots.resize('chart');
});
</script>
</body>
</html>